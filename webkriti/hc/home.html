<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="home.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
    
</head>
<body>
    
    <header>
        <div class="navbar">
            <a href="#home">Home</a>
            <a href="/cart">Add to cart</a>            
            <a href="#Favorites">Favorites</a>
            <a href="#contact">Contact Us</a>
        </div>
       
    </header>
    <div class="spinner-container">
        <div class="spinner">
            <div class="spinner1"></div>
        </div>
    </div>
    <div class ="looks">
        <img width="100%" height="500" src="https://www.cxtoday.com/wp-content/uploads/2022/03/ecommerce-3.png" alt="img bish">
    </div>
    <h1>Discover our wide range of products!</h1>
    <div class="featured-section" id="electronics">
        <h2>Electronics</h2>
        <div class="flip-card-container" id="electronics-cards"></div>
    </div>
    <div class="featured-section" id="fashion">
        <h2>Fashion</h2>
        <div class="flip-card-container" id="fashion-cards"></div>
    </div>
    <div class="featured-section" id="arts-crafts">
        <h2>Arts & Crafts</h2>
        <div class="flip-card-container" id="arts-crafts-cards"></div>
    </div>
    <div class="featured-section" id="household">
        <h2>Household</h2>
        <div class="flip-card-container" id="household-cards"></div>
    </div>
    <div class="featured-section" id="pet-supplies">
        <h2>Pet Supplies</h2>
        <div class="flip-card-container" id="pet-supplies-cards"></div>
    </div>

    <script>
       function fetchDataFromAPI(category, containerId) {
    fetch(`/products?category=${category}`)  // Include the category in the request URL
        .then((response) => response.json())
        .then((data) => {
            generateFlipCards(data, containerId);
        })
        .catch((error) => {
            console.error('Error fetching data:', error);
        });
}


        function generateFlipCards(data, containerId) {
            const container = document.getElementById(containerId);

            data.forEach((product) => {
                const flipCard = document.createElement('div');
                flipCard.classList.add('flip-card');

                const innerHTML = `
                    <div class="flip-card-inner">
                        <div class="flip-card-front" style="background-image: url('${product.url}')"></div>
                        <div class="flip-card-back">
                            <p class="title product-name">${product.name}</p>
                            <p>${product.description}</p>
                            <p class="product-price">${product.price}</p>
                            <div class="flip-card-button-container">
        <button class="add-to-cart-button">Add to Cart</button>
    </div>
                        </div>
                    </div>
                    `;

                flipCard.innerHTML = innerHTML;
                container.appendChild(flipCard);
            });
        }

        window.addEventListener('load', function () {
            fetchDataFromAPI('electronics', 'electronics-cards');
            fetchDataFromAPI('fashion', 'fashion-cards');
            fetchDataFromAPI('homeappliances','household-cards');
            fetchDataFromAPI('pet','pet-supplies-cards');
            fetchDataFromAPI('arts','arts-crafts-cards');

        });

        window.addEventListener('load', function () {
            const spinnerContainer = document.querySelector('.spinner-container');
            setTimeout(function () {
                spinnerContainer.style.display = 'none';
                window.scrollTo(0, 0);
            }, 900);
        });

        function addToCart(productName, productPrice) {
         
            const productDetails = {
                name: productName,
                price: productPrice,
                quantity: 1,
            };

           
            fetch('/add-to-cart', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(productDetails),
            })
            .then((response) => response.text())
            .then((message) => {
             
                console.log(message);
            })
            .catch((error) => {
                console.error(error);
            });
        }

      
        document.querySelectorAll('.add-to-cart-button').forEach((button) => {
            button.addEventListener('click', function () {
                console.log('Button clicked'); 
                const productName = this.closest('.flip-card').querySelector('.product-name').textContent;
                const productPrice = this.closest('.flip-card').querySelector('.product-price').textContent;

                addToCart(productName, productPrice);
            });
        });

    </script>
</body>
</html>